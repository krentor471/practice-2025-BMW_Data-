
# Руководство по установке и использованию Confession Bot

## Описание
**Confession** — это эмпатичный Telegram-бот для психологической поддержки, использующий YandexGPT.  
Он помогает пользователям разобраться в своих мыслях и эмоциях через активное слушание.

## Технические требования
- Python 3.10+
- Docker (для развертывания в контейнере)
- Учетная запись в Yandex Cloud (для API-ключей)
- Telegram аккаунт (для создания бота)

## 1. Получение API-ключей

### 1.1. Ключи Yandex Cloud
1. Зарегистрируйтесь в [Yandex Cloud](https://cloud.yandex.ru/)
2. Перейдите в раздел **"Управление ресурсами" → "Облако"**
3. Создайте новое облако или используйте существующее
4. В разделе **"Сервисные аккаунты"** создайте новый аккаунт
5. Назначьте роль `ai.languageModels.user`
6. В разделе **"API-ключи"** создайте новый ключ и сохраните его (`YC_API_KEY`)
7. ID каталога можно найти на странице облака (`YC_FOLDER_ID`)

### 1.2. Создание Telegram-бота
1. Откройте Telegram и найдите `@BotFather`
2. Отправьте команду `/newbot`
3. Укажите имя бота (например, `Confession Bot`)
4. Задайте уникальный username (должен заканчиваться на `bot`)
5. Сохраните полученный токен (`BOT_TOKEN`)

## 2. Установка (локальный запуск)

### 2.1. Клонирование репозитория
```bash
git clone https://github.com/ваш-репозиторий/confession-bot.git
cd confession-bot
```

### 2.2. Настройка окружения
Создайте файл `.env` в корне проекта:
```bash
touch .env
```

Пример содержания файла `.env`:
```env
BOT_TOKEN=ваш_telegram_токен
YC_API_KEY=ваш_yandex_api_ключ
YC_FOLDER_ID=ваш_yandex_folder_id
```

### 2.3. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 2.4. Запуск бота
```bash
python main.py
```

## 3. Развертывание в Docker

### 3.1. Сборка образа
```bash
docker build -t confession-bot .
```

### 3.2. Запуск контейнера
```bash
docker run -d --name confession-bot --env-file .env confession-bot
```

## 4. Использование бота
- Найдите своего бота в Telegram по username
- Отправьте команду `/start`
- Напишите о том, что вас беспокоит
- Бот будет отвечать с эмпатией и поддержкой

**Доступные команды:**
- `/start` — начать диалог
- `/reset` — очистить историю разговора

## 5. Безопасность
- `.env` добавлен в `.gitignore` по умолчанию
- Никогда не публикуйте свои API-ключи
- Для продакшена используйте секреты Docker или переменные окружения

## 6. Возможные проблемы и решения

**Проблема:** Ошибка подключения к YandexGPT API  
**Решение:** Проверьте:
- Правильность API-ключа и ID каталога
- Наличие прав у сервисного аккаунта
- Баланс в Yandex Cloud

**Проблема:** Бот не отвечает  
**Решение:** Проверьте:
- Запущен ли процесс бота
- Корректность токена Telegram-бота
- Наличие интернет-соединения

## 7. Дополнительные настройки
Вы можете изменить параметры модели в файле `main.py`:
```python
prompt = {
    "modelUri": f"gpt://{YC_FOLDER_ID}/{MODEL_NAME}",
    "completionOptions": {
        "stream": False,
        "temperature": 0.9,  # Уровень креативности (0-1)
        "maxTokens": 300     # Максимальная длина ответа
    },
    "messages": messages
}
```

## Контакты для поддержки
Если у вас возникли вопросы, обращайтесь: [ваши контакты]

---

Это руководство включает:
1. Все шаги от получения ключей до запуска в продакшене
2. Решения типовых проблем
3. Рекомендации по безопасности
4. Возможности кастомизации
